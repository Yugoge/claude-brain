# Personal Knowledge System

[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)
[![Built with Claude Code](https://img.shields.io/badge/Built%20with-Claude%20Code-blueviolet)](https://claude.com/code)
[![FSRS Algorithm](https://img.shields.io/badge/Review-FSRS-green)](https://github.com/open-spaced-repetition/fsrs4anki)

An AI-powered personal knowledge management and spaced repetition learning system built on Claude Code. Combines Socratic dialogue-based learning with scientifically-optimized spaced repetition for deep knowledge retention across multiple domains.

## âœ¨ Key Features

- **Interactive Learning**: Socratic dialogue, not passive reading
- **Smart Review**: FSRS algorithm for optimal retention (30-50% more efficient than traditional SM-2)
- **Knowledge Graph**: RemNote-style organization with bidirectional links and typed relations
- **Multi-Domain**: Finance, Programming, Language, Medicine, Law, Science, and more
- **Multi-Format**: PDF, EPUB, PowerPoint, Word, Excel, Markdown
- **Git-Friendly**: Everything stored as Markdown for version control
- **Token-Optimized**: 73% token savings through three-party consultation architecture

---

## ğŸš€ Quick Start

### Prerequisites

- Python 3.9+
- Claude Code (Desktop or CLI)
- Git

### Installation

1. **Clone the repository**:
```bash
git clone <your-fork-url>
cd knowledge-system
```

2. **Set up Python environment**:
```bash
source venv/bin/activate && source venv/bin/activate && python3 -m venv venv
source venv/bin/activate  # On Windows: venv\Scripts\activate
pip install -r requirements.txt
```

3. **Initialize the system**:
```bash
/kb-init
```

### Basic Workflow

```bash
# 1. Add learning material to appropriate domain folder
learning-materials/finance/options-trading.pdf

# 2. Start learning session
/learn learning-materials/finance/options-trading.pdf

# 3. AI tutor asks Socratic questions to test understanding

# 4. Save session (extracts concepts, maintains graph, syncs to review)
/save options-trading-session

# 5. Review regularly using spaced repetition
/review finance

# 6. Track your progress
/progress finance
```

---

## ğŸ“š Core Commands

| Command | Description |
|---------|-------------|
| `/learn <file-path>` | Start interactive Socratic learning session |
| `/save [topic]` | Extract concepts, maintain graph, archive conversation (all-in-one) |
| `/review [domainâ”‚concept-id]` | Review concepts using FSRS algorithm |
| `/progress [domainâ”‚file-path]` | View learning progress and analytics |
| `/ask <question>` | Ask any question with automatic web research |
| `/discover-relations <rem-idâ”‚--domain path>` | Discover typed relations for existing Rems |
| `/kb-init` | Initialize or repair knowledge system |

---

## ğŸ—ï¸ System Architecture

<!-- AUTO-GENERATED by rule-inspector - DO NOT EDIT -->
```
knowledge-system/
â”œâ”€â”€ .claude/                    # Claude Code configuration (16 commands, 11 agents)
â”‚   â”œâ”€â”€ commands/               # Slash commands (16 total)
â”‚   â”œâ”€â”€ agents/                 # AI tutors (11 total: language, finance, programming, etc.)
â”‚   â”œâ”€â”€ hooks/                  # Event-driven automation (9 hooks)
â”‚   â”œâ”€â”€ settings.json           # Hook configuration
â”‚   â””â”€â”€ CLAUDE.md               # System instructions
â”‚
â”œâ”€â”€ learning-materials/         # Original materials + progress tracking
â”‚   â”œâ”€â”€ finance/                # Finance domain (CFA, equity research, market research)
â”‚   â”œâ”€â”€ language/               # Language learning materials
â”‚   â”œâ”€â”€ programming/            # Programming materials
â”‚   â””â”€â”€ politics/               # Political science materials
â”‚
â”œâ”€â”€ knowledge-base/             # Extracted knowledge (Rem-style)
â”‚   â”œâ”€â”€ _index/                 # Auto-generated indexes
â”‚   â”‚   â”œâ”€â”€ backlinks.json      # Bidirectional link index
â”‚   â”‚   â””â”€â”€ graph-data.json     # Knowledge graph cache
â”‚   â”œâ”€â”€ _taxonomy/              # UNESCO ISCED taxonomy reference (10 broad fields)
â”‚   â””â”€â”€ [ISCED-code]/           # Domain-organized concepts
â”‚
â”œâ”€â”€ .review/                    # FSRS review system
â”‚   â”œâ”€â”€ schedule.json           # Review scheduling
â”‚   â”œâ”€â”€ history.json            # Review history
â”‚   â””â”€â”€ adaptive-history/       # Historical adaptive profiles
â”‚
â”œâ”€â”€ chats/                      # Conversation archives
â”‚   â”œâ”€â”€ index.json              # Searchable index with metadata aggregates
â”‚   â””â”€â”€ [YYYY-MM]/              # Monthly archives (2025-10 through 2026-01)
â”‚
â”œâ”€â”€ docs/                       # Documentation organized by category
â”‚   â”œâ”€â”€ guides/                 # User guides and tutorials
â”‚   â”œâ”€â”€ reference/              # Technical documentation
â”‚   â”œâ”€â”€ architecture/           # Architecture documentation and standards
â”‚   â”œâ”€â”€ dev/                    # Development workflow JSONs
â”‚   â”œâ”€â”€ clean/                  # Clean workflow JSONs
â”‚   â”œâ”€â”€ qa/                     # Quality assurance (assessments, gates)
â”‚   â”œâ”€â”€ archive/                # Historical documentation (2025-12)
â”‚   â””â”€â”€ [category]/             # Other categorized docs
â”‚
â””â”€â”€ scripts/                    # Maintenance utilities (140+ scripts)
    â”œâ”€â”€ archival/               # Conversation processing
    â”œâ”€â”€ knowledge-graph/        # Graph maintenance
    â”œâ”€â”€ learning-materials/     # File parsers
    â”œâ”€â”€ review/                 # FSRS implementation
    â”œâ”€â”€ hooks/                  # Hook utilities
    â”œâ”€â”€ agents/                 # Agent utilities
    â”œâ”€â”€ analytics/              # Analytics and visualizations
    â”œâ”€â”€ fact-check/             # Fact-checking utilities
    â”œâ”€â”€ github/                 # GitHub integration
    â”œâ”€â”€ maintenance/            # System maintenance
    â”œâ”€â”€ memory/                 # MCP memory utilities
    â”œâ”€â”€ progress/               # Progress tracking
    â”œâ”€â”€ services/               # Background services
    â”œâ”€â”€ todo/                   # Todo management
    â”œâ”€â”€ utilities/              # General utilities
    â”œâ”€â”€ validation/             # Validation scripts
    â””â”€â”€ archive/                # Archived scripts
```
<!-- END AUTO-GENERATED -->

### Agent Architecture

The system uses a **three-party consultation pattern** for optimal efficiency:

**Consultant Agents** (Silent domain experts):
- `language-tutor`, `finance-tutor`, `programming-tutor`, `book-tutor`, `medicine-tutor`, `law-tutor`, `science-tutor`, `review-master`, `analyst`
- Provide JSON consultations to main agent
- Never interact with user directly
- ~73% token savings vs direct interaction
- **Note**: All learning/review dialogue is conducted by main agent. Consultant agents provide silent JSON guidance.

**Knowledge Graph Maintenance** (Direct script calls):
- Auto-maintained by PostToolUse hooks + `/save` command
- No agent overhead - uses direct Python scripts

**See**: `architecture/agent-classification.md` for details

---

## ğŸ’¡ Core Concepts

### Rem-Style Knowledge Points

Each concept is stored as a minimal Markdown file (~100-120 tokens) with:
- **Hierarchical structure**: Parent â†’ Child relationships
- **Bidirectional links**: `[[concept-a]]` â†” `[[concept-b]]`
- **Typed relations**: synonym, antonym, prerequisite_of, etc.
- **Tags**: Domain, difficulty, topic tags
- **Dual taxonomy**: UNESCO ISCED + Dewey Decimal codes
- **Metadata**: Creation date, review history, FSRS data

### Typed Relations

The system supports semantic relationships:
- **Lexical**: synonym, antonym, hypernym, hyponym, part_of
- **Conceptual**: is_a, prerequisite_of, cause_of, example_of
- **Comparative**: contrasts_with, analogous_to, related

**Discovery**: Automatically during `/save` or manually via `/discover-relations`

**See**: `architecture/standards/RELATION_TYPES.md`

### FSRS Review System

- **Algorithm**: FSRS (Free Spaced Repetition Scheduler)
- **Efficiency**: 30-50% more efficient than traditional SM-2
- **Rating Scale**: 1-4 (1 = hard, 2 = medium, 3 = good, 4 = easy)
- **Adaptive**: Based on difficulty, stability, and retrievability
- **Conversation-based**: Not flashcards - test through Socratic dialogue

---

## ğŸ”§ Automation & Hooks

The system uses **9 hooks** for automatic safety checks and maintenance:

| Hook | Purpose |
|------|---------|
| **SessionStart** | Display count of due reviews |
| **UserPromptSubmit** | Prevent secret commits, review reminders |
| **PreToolUse (Bash)** | Block dangerous AI commands |
| **PreToolUse (Edit)** | Protect critical indexes |
| **PreToolUse (Read)** | Warn about large files (>5MB) |
| **PostToolUse (Edit)** | Auto-rebuild backlinks after edits |
| **SubagentStop** | Audit trail for review sessions |
| **PreCompact** | Backup conversation index |
| **Stop/SessionEnd** | Log session completion |

**Key Automation**: Every time you edit a knowledge file, the backlinks index is automatically rebuilt. No manual maintenance needed!

**See**: `architecture/hooks.md`

---

## ğŸ“– Learning Workflow

### 1. Add Learning Materials

Place materials in the appropriate domain folder:

```
learning-materials/
â”œâ”€â”€ finance/
â”‚   â”œâ”€â”€ options-trading.pdf
â”‚   â””â”€â”€ derivatives-handbook.epub
â”œâ”€â”€ programming/
â”‚   â”œâ”€â”€ python-deep-dive.pdf
â”‚   â””â”€â”€ algorithms-textbook.pdf
â””â”€â”€ language/
    â”œâ”€â”€ french-grammar.epub
    â””â”€â”€ spanish-vocab.pdf
```

### 2. Interactive Learning

```bash
/learn learning-materials/finance/options-trading.pdf
```

The AI tutor will:
- Present passages from the material
- Ask Socratic questions to test understanding
- Extract concepts as knowledge Rems
- Track your progress automatically

### 3. Save Session

```bash
/save options-trading-session
```

This one command:
- Extracts concepts as ultra-minimal Rems (100-120 tokens)
- Discovers typed relations via domain tutors
- Normalizes wikilinks automatically
- Rebuilds knowledge graph
- Syncs to FSRS review schedule
- Archives the conversation

### 4. Review Regularly

```bash
/review                    # Review all due concepts
/review finance            # Review finance concepts only
/review [[concept-id]]     # Review specific concept
```

### 5. Track Progress

```bash
/progress                  # Overall progress
/progress finance          # Domain-specific
/progress learning-materials/finance/options-trading.pdf  # Material-specific
```

---

## ğŸ“Š Knowledge Graph Visualization

The knowledge graph visualization is **automatically generated** after every `/save` command.

**Generated file**: `knowledge-graph.html` (in project root)

**Features**:
- D3.js force-directed graph with domain-colored nodes
- Interactive: zoom, pan, drag, click for details
- Hover to highlight connected concepts
- Search to filter and focus
- Auto-detected clusters
- Node size = review count

**How to view**: Simply open `knowledge-graph.html` in your browser after any `/save` operation.

---

## ğŸ› ï¸ Maintenance & Utilities

### Automatic Maintenance

Most maintenance is automated via hooks. For manual operations:

```bash
# Rebuild bidirectional links with typed relations
source venv/bin/activate && source venv/bin/activate && python3 scripts/knowledge-graph/rebuild-backlinks.py

# Convert [[wikilinks]] to clickable file links
source venv/bin/activate && source venv/bin/activate && python3 scripts/knowledge-graph/normalize-links.py --mode replace

# Add typed relation between concepts (with auto-reciprocal)
source venv/bin/activate && source venv/bin/activate && python3 scripts/knowledge-graph/add-relation.py \
  --from call-option --to put-option --type antonym

# Materialize two-hop inferred links (preview first!)
source venv/bin/activate && source venv/bin/activate && python3 scripts/knowledge-graph/materialize-inferred-links.py --dry-run
```

All scripts support:
- `--dry-run` - Preview changes without writing
- `--verbose` - Detailed debug output
- `--help` - Full usage documentation

### Large File Handling

The system automatically handles large files using smart chunking:

**Content-Aware Processing**:
- **Text-heavy PDFs** (textbooks): 5-10 pages at a time
- **Image-heavy PDFs** (picture books): 1 page at a time
- **Mixed content**: Adaptive 3-5 pages

**Size Thresholds**:

| Size Range | Action | Method |
|-----------|--------|---------|
| < 5 MB | âœ… Read normally | Standard `Read` tool |
| 5-20 MB | âš ï¸ Warn but allow | `Read` with warning |
| > 20 MB | â›” Block `Read` | **MUST** use chunking |

---

## ğŸ¯ Best Practices

### Learning

- **Daily consistency**: 30-60 minutes daily beats irregular long sessions
- **Active engagement**: Answer questions thoughtfully, don't rush
- **Make connections**: Link new concepts to existing knowledge
- **Review regularly**: Follow FSRS schedule for optimal retention

### Organization

- **One domain per material**: Place files in appropriate domain folder
- **Descriptive filenames**: Use clear, searchable names
- **Tag generously**: Tags help discover related concepts
- **Link proactively**: Create `[[links]]` during learning for better recall

### Review

- **Be honest**: Ratings must be accurate for FSRS to work
- **Don't cram**: Spaced repetition is more effective than massing
- **Apply knowledge**: Think about real-world applications
- **Note weak spots**: Concepts with low ratings need extra attention

---

## ğŸ” Troubleshooting

### "Context limit exceeded"
- Materials are chunked automatically
- Continue with `/learn` command to resume

### "Broken links detected"
- Run `source venv/bin/activate && python3 scripts/knowledge-graph/rebuild-backlinks.py`
- Check `knowledge-base/_index/backlinks.json`

### "No concepts due for review"
- Check `.review/schedule.json`
- View next review date with `/progress`

### "Agent not found"
- Verify agents exist in `.claude/agents/`
- Run `/kb-init` to repair

---

## ğŸ“ Git Workflow

### Initial Setup
```bash
git remote add origin <your-github-repo>
git push -u origin main
```

### Regular Commits
```bash
# After learning sessions
git add .
git commit -m "Learning session: options-trading - 5 concepts"
git push

# After review sessions
git add .review/
git commit -m "Review session: 10 concepts"
git push
```

### Sync Across Devices
```bash
git pull   # Before starting work
git push   # After sessions
```

---

## ğŸ“š Documentation

### For Users
- **[README.md](./README.md)** - This file (quick start and overview)
- **[architecture/](./architecture/)** - System architecture documentation

### For Developers
- **[architecture/agent-classification.md](./architecture/agent-classification.md)** - Agent types and consultation pattern
- **[architecture/hooks.md](./architecture/hooks.md)** - Hook system documentation
- **[architecture/conversation-index.md](./architecture/conversation-index.md)** - Conversation archive schema
- **[architecture/standards/](./architecture/standards/)** - Standards and conventions

---

## ğŸ¤ Contributing

This is a personal knowledge system template. Customize to your needs:

1. Add new domains to taxonomy
2. Create specialized agents for your fields
3. Modify progress tracking granularity
4. Adjust FSRS parameters for your learning style

---

## ğŸ“„ License

MIT License - Use freely for personal learning

---

## ğŸ™ Credits

Built with [Claude Code](https://claude.com/code) by Anthropic

Inspired by:
- **SuperMemo** - Spaced repetition pioneer
- **RemNote** - Knowledge graph and bidirectional links
- **Zettelkasten** - Note-taking methodology
- **FSRS** - Modern spaced repetition algorithm

---

## ğŸŒŸ System Highlights

### What Makes This System Unique?

1. **Socratic Dialogue**: Unlike traditional flashcards, the system uses AI-powered Socratic questioning to develop deep understanding

2. **Three-Party Architecture**: Innovative consultation pattern reduces token usage by 73% while maintaining expert guidance

3. **Typed Relations**: Semantic relationships between concepts (prerequisite_of, synonym, contrasts_with) enable intelligent review scheduling and knowledge discovery

4. **Automatic Maintenance**: Hooks ensure indexes and links stay synchronized without manual intervention

5. **Multi-Format Support**: Learn from PDFs, EPUBs, PowerPoint, Word, Excel, and Markdown with intelligent chunking

6. **Domain Expertise**: Specialized tutors for Language, Finance, Programming, Medicine, Law, and Science provide tailored learning experiences

7. **Git-Based**: Everything is Markdown - version control, sync across devices, full ownership of your data

8. **FSRS Algorithm**: State-of-the-art spaced repetition 30-50% more efficient than traditional methods

---

## ğŸ“Š Recent Structural Changes

Last 30 days:

- 2026-01-08 15:58:26 +0000: fix(review): remove forced follow-up mechanism
- 2026-01-08 13:19:02 +0000: Update: Comprehensive changes via push script
- 2026-01-08 10:08:58 +0000: fix(review): separate format diversity logic from format preference enforcement
- 2026-01-07 23:49:57 +0000: fix(ask): Expand analyst trigger conditions + global Playwright output dir
- 2025-12-27 01:30:17 +0000: fix: Remove obsolete Netlify deployment (superseded by GitHub Pages)
- 2025-12-27 01:18:21 +0000: cleanup: Phase 2 - Code standards and style fixes
- 2025-12-27 01:10:19 +0000: cleanup: Phase 1 - File organization and archival
- 2025-12-20 18:36:05 +0000: fix(learn): Clarify domain focus to test language skills, not content knowledge
- 2025-12-17 08:51:00 +0000: fix(orchestrator): normalize tutor relation field names

---

## ğŸ” Git Analysis

<!-- AUTO-GENERATED by rule-inspector - DO NOT EDIT -->
**Project initialized**: 2025-10-26
**Last structural update**: 2026-01-08 15:58:26 +0000
**Total commits**: 994
<!-- END AUTO-GENERATED -->

---

Happy learning! ğŸ“

For questions or issues, please open an issue on GitHub.

---

*Root README updated by rule-inspector on 2026-01-08 to reflect current project structure*
